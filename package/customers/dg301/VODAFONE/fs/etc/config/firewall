config defaults
	option syn_flood	1
	option input		ACCEPT
	option output		ACCEPT
	option forward		REJECT

config zone
	option name		lan
	list network		'lan'
	option input		ACCEPT
	option output		ACCEPT
	option forward		ACCEPT

config zone
	option name	     guest
	option network	  'guest'
	option input	    REJECT
	option forward	  REJECT
	option output	   ACCEPT

config zone
	option name		wan
	list network		'GPON_Internet'
	list network		'GPON_VoIP'
	list network		'GPON_IPTV'
	list network		'GPON_Internet6'
	option input		REJECT
	option output		ACCEPT
	option forward		REJECT
	option masq		1
	option mtu_fix		1

config forwarding
	option src		lan
	option dest		wan

config forwarding
	option src guest
	option dest wan

config rule
	option name 'Allow DNS Queries'
	option src 'guest'
	option dest_port '53'
	option proto 'tcpudp'
	option target 'ACCEPT'

config rule
	option name 'Allow DHCP request'
	option src 'guest'
	option src_port '67-68'
	option dest_port '67-68'
	option proto 'udp'
	option target 'ACCEPT'

config rule
	option name		Allow-DHCP-Renew
	option src		wan
	option proto		udp
	option dest_port	68
	option family		ipv4
	option target		ACCEPT
	option hidden '1'

config rule
	option name		'Allow Ping to WAN interface'
	option src		wan
	option proto		icmp
	option icmp_type	echo-request
	option family		ipv4
	option target		ACCEPT
	option hidden '0'

config rule
	option name		Allow-SSH
	option src		wan
	option proto		tcp
	option dest_port	22
	option family		ipv4
	option target		ACCEPT
	option hidden		1

# Allow DHCPv6 replies
config rule
	option name		Allow-DHCPv6
	option src		wan
	option proto		udp
	option src_ip		fe80::/10
	option src_port		547
	option dest_ip		fe80::/10
	option dest_port	546
	option family		ipv6
	option target		ACCEPT
	option hidden '1'

config rule
	option name		Allow-ICMPv6-Input
	option src		wan
	option proto		icmp
	list icmp_type		echo-request
	list icmp_type		echo-reply
	list icmp_type		destination-unreachable
	list icmp_type		packet-too-big
	list icmp_type		time-exceeded
	list icmp_type		bad-header
	list icmp_type		unknown-header-type
	list icmp_type		router-solicitation
	list icmp_type		neighbour-solicitation
	list icmp_type		router-advertisement
	list icmp_type		neighbour-advertisement
	option limit		1000/sec
	option family		ipv6
	option target		ACCEPT
	option hidden '1'

config rule
	option name		Allow-ICMPv6-Forward
	option src		wan
	option dest		*
	option proto		icmp
	list icmp_type		echo-request
	list icmp_type		echo-reply
	list icmp_type		destination-unreachable
	list icmp_type		packet-too-big
	list icmp_type		time-exceeded
	list icmp_type		bad-header
	list icmp_type		unknown-header-type
	option limit		1000/sec
	option family		ipv6
	option target		ACCEPT
	option hidden '1'

config rule
	option name 'DataFlex'
	option family 'ipv4'
	option proto 'tcp'
	option src 'wan'
	list src_ip '212.18.165.232/29'
	list src_ip '212.18.165.240/28'
	list src_ip '213.30.6.36/30'
	list src_ip '213.30.6.40/29'
	list src_ip '213.30.6.48/28'
	list src_ip '213.30.6.64/26'
	list src_ip '213.30.6.128/25'
	list src_ip '212.18.162.33/32'
	list src_ip '212.18.162.34/32'
	list src_ip '212.18.162.35/32'
	list src_ip '212.18.162.36/30'
	list src_ip '212.18.162.40/29'
	list src_ip '212.18.162.48/28'
	list src_ip '212.18.162.64/26'
	list src_ip '212.18.162.128/25'
	list src_ip '213.30.111.213/32'
	list src_ip '213.30.111.214/32'
	list src_ip '213.30.111.215/32'
	list src_ip '213.30.111.216/29'
	list src_ip '213.30.111.224/27'
	option dest 'lan'
	option dest_port '8008 23023'
	#list dest_ip '172.31.32.34/32'
	option target 'ACCEPT'
	option hidden '1'

# include a file with users custom iptables rules
config include
	option path /etc/firewall.user
	option reload 1

# include a file with rules for SIP and RTP traffic
config include
	option path /etc/firewall.sip
	option reload 1

config include 'cwmp'
	option path '/etc/firewall.cwmp'
	option reload '1'

config include 'miniupnpd'
	option type 'script'
	option path '/usr/share/miniupnpd/firewall.include'
	option family 'any'
	option reload '1'

config include
	option path '/etc/firewall.dmz'
	option reload '1'


